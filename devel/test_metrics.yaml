---
metrics:
  - name: Companies contributing in repositories
    series_name_or_func: multi_row_multi_column
    sql: num_stats_repos
    periods: d,w,m,q
    aggregate: 1,7,28
    skip: d,w7,m7,q7,w28,m28,q28
    merge_series: num_stats_repos
    drop: snum_stats_repos
  - name: Company statistics by repositories
    series_name_or_func: multi_row_multi_column
    sqls: [company_activity_repos, company_activity_commits_repos]
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    multi_value: true
    merge_series: company_activity_repos
    drop: scompany_activity_repos
  - name: Bot commands repositories
    series_name_or_func: multi_row_single_column
    sql: bot_commands_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    multi_value: true
    merge_series: bot_commands_repos
    drop:  sbot_commands_repos
  - name: Contributions chart (repositories)
    series_name_or_func: multi_row_multi_column
    sqls: [reviewers_repos, approvers_repos, committers_repos, contributors_repos]
    periods: d,w,m
    aggregate: 1,7
    skip: d,w7,m7
    merge_series: csr
    drop: scsr
    project: kubernetes
    env:
      GHA2DB_NCPUS?: 8
  - name: New and episodic PR contributors (repositories)
    series_name_or_func: multi_row_multi_column
    sql: new_contributors_repos
    periods: d,w,m,q,y
    aggregate: 1,28
    skip: d,w28,m28,q28,y28
    merge_series: new_contributors_repos
    drop: snew_contributors_repos
  - name: New and episodic PR contributors (repositories)
    series_name_or_func: multi_row_multi_column
    sql: episodic_contributors_repos
    periods: d,w,m,q,y
    aggregate: 1,28
    skip: d,w28,m28,q28,y28
    merge_series: episodic_contributors_repos
    drop: sepisodic_contributors_repos
  - name: New contributors by repositories
    series_name_or_func: multi_row_single_column
    sql: new_contributors_data_repos
    custom_data: true
    merge_series: new_contributors_data_repos
    periods: d
    drop: snew_contributors_data_repos
  - name: PRs authors repositories
    series_name_or_func: multi_row_single_column
    sql: prs_authors_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    merge_series: pr_auth_repos
    drop: spr_auth_repos
  - name: Inactive issues by SIG and repository
    series_name_or_func: multi_row_multi_column
    sql: inactive_issues_by_sig_repos
    periods: d
    multi_value: true
    drop: 'sinactive_issues_by_sig_reposw2;sinactive_issues_by_sig_reposd30;sinactive_issues_by_sig_reposd90'
    env:
      GHA2DB_NCPUS?: 8
  - name: Inactive PRs by SIG and repository
    series_name_or_func: multi_row_multi_column
    sql: inactive_prs_by_sig_repos
    periods: d
    multi_value: true
    drop: 'sinactive_prs_by_sig_reposw2;sinactive_prs_by_sig_reposd30;sinactive_prs_by_sig_reposd90'
    env:
      GHA2DB_NCPUS?: 8
  - name: Issues age by SIG and repository
    series_name_or_func: multi_row_multi_column
    sql: issues_age_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    desc: time_diff_as_string
    merge_series: issues_age_repos
    drop: sissues_age_repos
  - name: Issues opened/closed by SIG and repository
    series_name_or_func: multi_row_single_column
    sql: labels_sig_kind_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    merge_series: sigm_lskr
    drop: ssigm_lskr
  - name: Issues opened/closed by SIG and repository
    series_name_or_func: multi_row_single_column
    sql: labels_sig_kind_closed_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: w7,m7,q7,y7
    merge_series: iclosed_lskr
    drop: siclosed_lskr
  - name: New and episodic issue creators (repositories)
    series_name_or_func: multi_row_multi_column
    sql: new_issues_repos
    periods: d,w,m,q,y
    aggregate: 1,28
    skip: d,w28,m28,q28,y28
    merge_series: new_issues_repos
    drop: snew_issues_repos
  - name: New and episodic issue creators (repositories)
    series_name_or_func: multi_row_multi_column
    sql: episodic_issues_repos
    periods: d,w,m,q,y
    aggregate: 1,28
    skip: d,w28,m28,q28,y28
    merge_series: episodic_issues_repos
    drop: sepisodic_issues_repos
  - name: Awaiting PRs by SIG and repository
    series_name_or_func: multi_row_multi_column
    sql: awaiting_prs_by_sig_repos
    periods: d
    multi_value: true
    drop: 'sawaiting_prs_by_sig_reposd10;sawaiting_prs_by_sig_reposd30;sawaiting_prs_by_sig_reposd60;sawaiting_prs_by_sig_reposd90;sawaiting_prs_by_sig_reposy'
  - name: Blocked PRs by repository
    series_name_or_func: multi_row_multi_column
    sql: prs_blocked_repos
    periods: d,w,m,q,y
    aggregate: 1,7
    skip: d,w7,m7,q7,y7
    multi_value: true
    drop: 'srepprblckall;srepprblckdo_not_merge;srepprblckneeds_ok_to_test;srepprblckno_approve;srepprblckno_lgtm;srepprblckrelease_note_label_needed'
  - name: Overall project statistics by repository
    histogram: true
    annotations_ranges: true
    series_name_or_func: multi_row_single_column
    sql: project_stats_repo
    merge_series: pstat_repos
  - name: Company PRs in repositories
    sql: company_prs_repos
    series_name_or_func: company_prs_repos
    histogram: true
    annotations_ranges: true
  - name: Developer activity counts (repositories)
    histogram: true
    annotations_ranges: true
    series_name_or_func: multi_row_single_column
    sqls: [hist_reviewers_repos, hist_approvers_repos, project_developer_stats_repos]
    merge_series: hdev_repos
    env:
      GHA2DB_NCPUS?: 8
